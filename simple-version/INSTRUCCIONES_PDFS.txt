================================================================================
  üé´ SISTEMA DE GENERACI√ìN Y DESCARGA DE PDFs - INSTRUCCIONES R√ÅPIDAS
================================================================================

‚úÖ IMPLEMENTACI√ìN COMPLETADA

Se ha integrado la API de generaci√≥n de boletos en PDF.
Los administradores pueden generar PDFs y los usuarios pueden descargarlos.

================================================================================
üì¶ PASO 1: INSTALAR DEPENDENCIAS
================================================================================

Abre una terminal en la carpeta "simple-version" y ejecuta:

    pip install -r requirements.txt

Esto instalar√°:
- Flask==3.0.0
- Werkzeug==3.0.1
- requests==2.31.0 (NUEVA - necesaria para la API)

================================================================================
üöÄ PASO 2: INICIAR EL SERVIDOR
================================================================================

Opci√≥n A - Windows:
    EJECUTAR.bat

Opci√≥n B - Linux/Mac:
    ./EJECUTAR.sh

Opci√≥n C - Manual:
    python app.py

El servidor iniciar√° en: http://localhost:5000

================================================================================
üëë PASO 3: PANEL DE ADMINISTRACI√ìN
================================================================================

1. Accede a: http://localhost:5000/admin

2. Credenciales:
   Usuario: admin@rifa.com
   Contrase√±a: admin123

3. Ver√°s una NUEVA PESTA√ëA: "üìÑ Generar PDFs"

================================================================================
üìÑ PASO 4: GENERAR PDFs (ADMINISTRADOR)
================================================================================

En la pesta√±a "üìÑ Generar PDFs":

1. Selecciona la PLANTILLA:
   ‚óã Gris (por defecto)
   ‚óã Negro

2. Selecciona la AGRUPACI√ìN:
   ‚óã 4 boletos por hoja (recomendado)
   ‚óã Individual

3. Ingresa los N√öMEROS DE BOLETOS separados por coma:
   Ejemplo: 1, 5, 10, 25, 100

4. Haz clic en "üìÑ Generar PDFs"

5. O bien, haz clic en "üì¶ Generar Todos los Vendidos"
   (Genera PDFs de TODOS los boletos con estado vendido/f√≠sico)

NOTA IMPORTANTE: Solo puedes generar PDFs de boletos VENDIDOS o F√çSICOS.
                 Aseg√∫rate de aprobar las transferencias primero.

================================================================================
üë§ PASO 5: DESCARGA DE PDFs (USUARIO)
================================================================================

Los usuarios pueden descargar sus boletos desde el Dashboard:

1. Usuario accede a: http://localhost:5000/dashboard

2. Ve sus compras APROBADAS

3. Si los PDFs han sido generados, ver√°:
   üì• Descargar mis Boletos en PDF

4. Si los PDFs a√∫n no se han generado, ver√°:
   ‚ÑπÔ∏è Generando PDFs
   Los PDFs de tus boletos est√°n siendo generados.

5. Al hacer clic en el bot√≥n de descarga, se descargar√° un ZIP
   con todos sus boletos en PDF

================================================================================
üîÑ FLUJO COMPLETO DE EJEMPLO
================================================================================

1. Usuario compra boletos (ej: #1, #5, #10)
2. Usuario sube comprobante de transferencia
3. Admin aprueba la transferencia (en pesta√±a "Transferencias Pendientes")
4. Admin genera PDFs:
   - Va a "üìÑ Generar PDFs"
   - Ingresa: 1, 5, 10
   - Clic en "Generar PDFs"
   - ‚úÖ PDFs generados correctamente
5. Usuario regresa a su Dashboard
6. Ve el bot√≥n: üì• Descargar mis Boletos en PDF
7. Descarga el ZIP con sus 3 boletos

================================================================================
üìÅ ARCHIVOS Y CARPETAS
================================================================================

Se crearon/modificaron los siguientes archivos:

MODIFICADOS:
- app.py                     (Backend con nuevos endpoints)
- requirements.txt           (Agregada librer√≠a requests)
- templates/admin.html       (Nueva pesta√±a para generar PDFs)
- templates/dashboard.html   (Bot√≥n de descarga para usuarios)

NUEVOS:
- tickets_pdf/              (Carpeta donde se guardan los PDFs)
- FUNCIONALIDAD_PDFS.md     (Documentaci√≥n completa)
- RESUMEN_IMPLEMENTACION_PDFS.md (Resumen t√©cnico)
- INSTRUCCIONES_PDFS.txt    (Este archivo)

================================================================================
üîß CONFIGURACI√ìN DE LA API
================================================================================

La API utilizada est√° en:
https://tickets-fqbvdgbeewbedkfs.centralus-01.azurewebsites.net

Par√°metros soportados:
- numbers: Lista de n√∫meros separados por comas (1,2,3,4)
- template: "gris" o "negro"
- associate: true (4 por hoja) o false (individual)

No necesitas configurar nada, todo est√° listo para funcionar.

================================================================================
‚ùì SOLUCI√ìN DE PROBLEMAS
================================================================================

PROBLEMA: Error al generar PDFs
SOLUCI√ìN: 
- Verifica que tengas conexi√≥n a internet
- Verifica que los boletos est√©n VENDIDOS
- Revisa los logs del servidor

PROBLEMA: El usuario no ve el bot√≥n de descarga
SOLUCI√ìN:
- Verifica que la compra est√© APROBADA
- Genera los PDFs desde el panel de admin
- Refresca la p√°gina del dashboard

PROBLEMA: Error "Module requests not found"
SOLUCI√ìN:
- pip install requests
- O ejecuta: pip install -r requirements.txt

================================================================================
üìä ENDPOINTS DE API AGREGADOS
================================================================================

POST /api/admin/generar-pdfs
- Genera PDFs de boletos (solo admin)
- Body: {"boletos": [1,2,3], "template": "negro", "associate": true}

GET /api/descargar-boletos
- Descarga PDFs de boletos del usuario
- Retorna: Archivo ZIP con los boletos

GET /api/usuario/compras (modificado)
- Ahora incluye campo "tiene_pdf" en cada compra

================================================================================
üìù BASE DE DATOS
================================================================================

Se agregaron 2 columnas a la tabla "boletos":

- pdf_generado (INTEGER): 0 = No generado, 1 = Generado
- pdf_filename (TEXT): Nombre del archivo ZIP

La migraci√≥n se ejecuta AUTOM√ÅTICAMENTE al iniciar el servidor.

================================================================================
‚úÖ VERIFICACI√ìN
================================================================================

Para verificar que todo funciona:

1. ‚úÖ Servidor inicia sin errores
2. ‚úÖ Puedes acceder a /admin
3. ‚úÖ Ves la pesta√±a "üìÑ Generar PDFs"
4. ‚úÖ Puedes generar PDFs (verifica que haya boletos vendidos)
5. ‚úÖ Los usuarios ven el bot√≥n de descarga

================================================================================
üéâ ¬°TODO LISTO!
================================================================================

El sistema est√° completamente funcional.

Para m√°s informaci√≥n t√©cnica, consulta:
- FUNCIONALIDAD_PDFS.md
- RESUMEN_IMPLEMENTACION_PDFS.md

Fecha de implementaci√≥n: 22 de Diciembre, 2025
Estado: ‚úÖ COMPLETADO Y FUNCIONAL

================================================================================

